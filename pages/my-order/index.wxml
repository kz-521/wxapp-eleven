<view class="page">
  <!-- æ ‡ç­¾é¡µå¤´éƒ¨ -->
  <view class="tab-header">
    <view class="tab-container">
      <view class="tab-item">
        <text class="tab-text {{activeTab === 1 ? 'active' : ''}}" bindtap="switchTab" data-tab="1">å…¨éƒ¨</text>
        <image wx:if="{{activeTab === 1}}" src="/imgs/item-bottom.png" class="tab-underline"></image>
      </view>
      <view class="tab-item">
        <text class="tab-text {{activeTab === 2 ? 'active' : ''}}" bindtap="switchTab" data-tab="2">å¾…å–èŒ¶</text>
        <image wx:if="{{activeTab === 2}}" src="/imgs/item-bottom.png" class="tab-underline"></image>
      </view>
      <view class="tab-item">
        <text class="tab-text {{activeTab === 3 ? 'active' : ''}}" bindtap="switchTab" data-tab="3">å·²å®Œæˆ</text>
        <image wx:if="{{activeTab === 3}}" src="/imgs/item-bottom.png" class="tab-underline"></image>
      </view>
      <view class="tab-item">
        <text class="tab-text {{activeTab === 4 ? 'active' : ''}}" bindtap="switchTab" data-tab="4">å·²å–æ¶ˆ</text>
        <image wx:if="{{activeTab === 4}}" src="/imgs/item-bottom.png" class="tab-underline"></image>
      </view>
    </view>
    <view class="tab-divider">
      <image src="https://lanhu-oss-proxy.lanhuapp.com/SketchPng691d7939005bfbefde8c100224afa8d615d8a32c4bf7a012731f3ddb754eeaec" class="divider-line"></image>
    </view>
  </view>

  <!-- è®¢å•åˆ—è¡¨ -->
  <view class="order-list" wx:if="{{orders.length > 0}}">
    <view class="order-item" wx:for="{{orders}}" wx:key="id" bindtap="goToOrderDetail" data-order-id="{{item.id}}">
      <!-- è®¢å•å¤´éƒ¨ä¿¡æ¯ -->
      <view class="order-header">
        <view class="order-type-info">
          <view class="order-type-tag">
            <text class="order-type-text">å ‚é£Ÿ</text>
          </view>
          <text class="store-name">æ¸…æ±€.æ–°å…»ç”Ÿç©ºé—´</text>
        </view>
        <text class="order-status">{{item.statusText}}</text>
      </view>

      <!-- å•†å“åˆ—è¡¨ -->
      <view class="product-item" wx:for="{{item.products}}" wx:key="id" wx:for-item="product">
        <view class="product-info">
          <view class="product-image-wrapper">
            <image src="{{product.image}}" class="product-image"></image>
          </view>
          <view class="product-details">
            <text class="product-name">{{product.name}}</text>
            <text class="product-specs">{{product.specs}}</text>
          </view>
        </view>
        <text class="product-count">x {{product.count}}</text>
      </view>

      <!-- è®¢å•åº•éƒ¨ä¿¡æ¯ -->
      <view class="order-footer">
        <text class="order-time">{{item.createTime}}</text>
        <view class="order-summary">
          <text class="order-summary-text">å…±{{item.totalCount}}ä»¶å•†å“ åˆè®¡ï¼š</text>
          <text class="order-total-price">Â¥{{item.totalPrice}}</text>
        </view>
      </view>

      <!-- è®¢å•æ“ä½œæŒ‰é’® -->
      <view class="order-actions" wx:if="{{item.status === 1}}">
        <view class="pay-button-wrapper" catchtap="goToPay" data-id="{{item.id}}" data-total-price="{{item.totalPrice}}">
          <text class="pay-button-text">å»æ”¯ä»˜</text>
        </view>
      </view>
    </view>
    <image src="https://lanhu-oss-proxy.lanhuapp.com/SketchPng78f8f9efda663741e8c554d0bbb1c6c3dcee97e0a6860271affc0586bb19695b" class="order-separator" wx:if="{{index < orders.length - 1}}"></image>
  </view>

  <!-- ç©ºçŠ¶æ€ -->
  <view wx:else class="empty-state">
    <view class="empty-icon">ğŸ“¦</view>
    <view class="empty-text">æš‚æ— è®¢å•</view>
  </view>

  <!-- åŠ è½½çŠ¶æ€ -->
  <view wx:if="{{loading}}" class="loading-state">
    <view class="loading-text">åŠ è½½ä¸­...</view>
  </view>

  <!-- æ”¯ä»˜æ–¹å¼é€‰æ‹©å¼¹çª— -->
  <view class="payment-modal" wx:if="{{showPaymentModal}}" catchtap="hidePaymentModal">
    <view class="payment-modal-content" catchtap="stopPropagation">
      <view class="payment-modal-header">
        <text class="payment-modal-title">é€‰æ‹©æ”¯ä»˜æ–¹å¼</text>
        <view class="payment-modal-close" bindtap="hidePaymentModal">
          <text class="close-text">âœ•</text>
        </view>
      </view>

      <view class="payment-methods">
        <view class="payment-method-item" wx:for="{{paymentMethods}}" wx:key="id" bindtap="selectPaymentMethod" data-method="{{item.id}}">
          <view class="payment-method-left">
            <image src="{{item.icon}}" class="payment-method-icon"></image>
            <view class="payment-method-info">
              <text class="payment-method-name">{{item.name}}</text>
              <text class="payment-method-desc">{{item.description}}</text>
            </view>
          </view>
          <view class="payment-method-selector">
            <view class="selector-circle {{item.selected ? 'selected' : 'unselected'}}">
              <view class="selector-dot" wx:if="{{item.selected}}"></view>
            </view>
          </view>
        </view>
      </view>

      <view class="payment-modal-footer">
        <button class="confirm-payment-btn" bindtap="confirmPayment">ç¡®è®¤æ”¯ä»˜</button>
      </view>
    </view>
  </view>
</view>
